# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –≥–æ–ª–æ—Å–æ–≤—ã–º –∑–≤–æ–Ω–∫–∞–º –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —ç–∫—Ä–∞–Ω–∞

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

P2P Web Messenger —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:
- üé§ –ì–æ–ª–æ—Å–æ–≤—ã–µ –∑–≤–æ–Ω–∫–∏ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- üñ•Ô∏è –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é —ç–∫—Ä–∞–Ω–∞ –≤–æ –≤—Ä–µ–º—è –∑–≤–æ–Ω–∫–∞
- üîá –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∏–∫—Ä–æ—Ñ–æ–Ω–æ–º (–≤–∫–ª/–≤—ã–∫–ª)
- üîî –ó–≤—É–∫–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–∑–≤–æ–Ω–æ–∫, –≥—É–¥–∫–∏, –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ)

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –°–æ–≤–µ—Ä—à–µ–Ω–∏–µ –∑–≤–æ–Ω–∫–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ —á–∞—Ç —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"üìû –ü–æ–∑–≤–æ–Ω–∏—Ç—å"** –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ —á–∞—Ç–∞
3. –†–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É, –µ—Å–ª–∏ –±—Ä–∞—É–∑–µ—Ä –∑–∞–ø—Ä–æ—Å–∏—Ç
4. –î–æ–∂–¥–∏—Ç–µ—Å—å, –ø–æ–∫–∞ —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫ –ø—Ä–∏–º–µ—Ç –∑–≤–æ–Ω–æ–∫

### –ü—Ä–∏–µ–º –∑–≤–æ–Ω–∫–∞

1. –ü—Ä–∏ –≤—Ö–æ–¥—è—â–µ–º –∑–≤–æ–Ω–∫–µ –ø–æ—è–≤–∏—Ç—Å—è –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –∏–º–µ–Ω–µ–º –∑–≤–æ–Ω—è—â–µ–≥–æ
2. –ù–∞–∂–º–∏—Ç–µ **"‚úì –ü—Ä–∏–Ω—è—Ç—å"** –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è –∑–≤–æ–Ω–∫–∞
3. –ù–∞–∂–º–∏—Ç–µ **"‚úó –û—Ç–∫–ª–æ–Ω–∏—Ç—å"** –¥–ª—è –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –∑–≤–æ–Ω–∫–∞
4. –†–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É –ø—Ä–∏ –ø—Ä–∏–Ω—è—Ç–∏–∏

### –í–æ –≤—Ä–µ–º—è –∑–≤–æ–Ω–∫–∞

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∏–∫—Ä–æ—Ñ–æ–Ω–æ–º
- –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **üé§ –ú–∏–∫—Ä–æ—Ñ–æ–Ω** –¥–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è/–≤–∫–ª—é—á–µ–Ω–∏—è –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
- –ò–∫–æ–Ω–∫–∞ –∏–∑–º–µ–Ω–∏—Ç—Å—è –Ω–∞ üîá –∫–æ–≥–¥–∞ –º–∏–∫—Ä–æ—Ñ–æ–Ω –≤—ã–∫–ª—é—á–µ–Ω

#### –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —ç–∫—Ä–∞–Ω–∞
- –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **üñ•Ô∏è –≠–∫—Ä–∞–Ω** –¥–ª—è –Ω–∞—á–∞–ª–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
- –í—ã–±–µ—Ä–∏—Ç–µ –æ–∫–Ω–æ/—ç–∫—Ä–∞–Ω –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
- –ù–∞–∂–º–∏—Ç–µ **–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å** –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
- –°–æ–±–µ—Å–µ–¥–Ω–∏–∫ —É–≤–∏–¥–∏—Ç –≤–∞—à —ç–∫—Ä–∞–Ω –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

#### –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–≤–æ–Ω–∫–∞
- –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **üìû –ó–∞–≤–µ—Ä—à–∏—Ç—å** –¥–ª—è –æ–∫–æ–Ω—á–∞–Ω–∏—è –∑–≤–æ–Ω–∫–∞
- –ó–≤–æ–Ω–æ–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∑–≤–æ–Ω–∫–æ–≤ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–¥—É–ª–µ–π:

- **CallManager** - —É–ø—Ä–∞–≤–ª—è–µ—Ç –ª–æ–≥–∏–∫–æ–π –∑–≤–æ–Ω–∫–æ–≤ –∏ –º–µ–¥–∏–∞-–ø–æ—Ç–æ–∫–∞–º–∏
- **AudioManager** - —É–ø—Ä–∞–≤–ª—è–µ—Ç –∑–≤—É–∫–æ–≤—ã–º–∏ —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏
- **CallUI** - —É–ø—Ä–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –∑–≤–æ–Ω–∫–æ–≤
- **ConnectionManager** - —Ä–∞—Å—à–∏—Ä–µ–Ω –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –º–µ–¥–∏–∞-—Ç—Ä–µ–∫–æ–≤

### –°–∏–≥–Ω–∞–ª—ã

–ù–æ–≤—ã–µ —Ç–∏–ø—ã —Å–∏–≥–Ω–∞–ª–æ–≤ —á–µ—Ä–µ–∑ WebSocket:
- `call-offer` - –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∑–≤–æ–Ω–∫–∞
- `call-answer` - –ø—Ä–∏–Ω—è—Ç–∏–µ –∑–≤–æ–Ω–∫–∞
- `call-reject` - –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –∑–≤–æ–Ω–∫–∞
- `call-end` - –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–≤–æ–Ω–∫–∞
- `screen-share-start` - –Ω–∞—á–∞–ª–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —ç–∫—Ä–∞–Ω–∞
- `screen-share-stop` - –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —ç–∫—Ä–∞–Ω–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –±—Ä–∞—É–∑–µ—Ä–∞

- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ WebRTC (Chrome, Firefox, Safari, Edge)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ getUserMedia API –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ getDisplayMedia API –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —ç–∫—Ä–∞–Ω–∞
- HTTPS —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ (–¥–ª—è production)

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –æ—à–∏–±–∫–∏:
- –û—Ç–∫–∞–∑ –≤ –¥–æ—Å—Ç—É–ø–µ –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
- –û—Ç–º–µ–Ω–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —ç–∫—Ä–∞–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
- –ü–æ—Ç–µ—Ä—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –≤–æ –≤—Ä–µ–º—è –∑–≤–æ–Ω–∫–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–æ—Ç–µ—Ä–µ —Å–≤—è–∑–∏

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
client/js/modules/
‚îú‚îÄ‚îÄ CallManager.js      # –õ–æ–≥–∏–∫–∞ –∑–≤–æ–Ω–∫–æ–≤
‚îú‚îÄ‚îÄ AudioManager.js     # –ó–≤—É–∫–æ–≤—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
‚îî‚îÄ‚îÄ CallUI.js          # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∑–≤–æ–Ω–∫–æ–≤

client/styles/
‚îî‚îÄ‚îÄ call.css           # –°—Ç–∏–ª–∏ –¥–ª—è UI –∑–≤–æ–Ω–∫–æ–≤

server/
‚îî‚îÄ‚îÄ index.js           # –û–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –ø–µ—Ä–µ—Å—ã–ª–∫–∏ call-—Å–∏–≥–Ω–∞–ª–æ–≤
```

### –°–æ–±—ã—Ç–∏—è CallManager

```javascript
// –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è
callManager.on('incomingCall', (username) => { ... });
callManager.on('callAccepted', (username) => { ... });
callManager.on('callRejected', (username) => { ... });
callManager.on('callEnded', () => { ... });
callManager.on('remoteStream', (stream) => { ... });
callManager.on('screenShareStarted', (stream) => { ... });
callManager.on('screenShareStopped', () => { ... });
callManager.on('microphonePermissionError', (message) => { ... });
callManager.on('connectionDisconnected', () => { ... });
callManager.on('connectionRestored', () => { ... });
```

### API CallManager

```javascript
// –ò–Ω–∏—Ü–∏–∞—Ü–∏—è –∑–≤–æ–Ω–∫–∞
await callManager.initiateCall(remoteUsername);

// –ü—Ä–∏–Ω—è—Ç–∏–µ –∑–≤–æ–Ω–∫–∞
await callManager.acceptCall(remoteUsername);

// –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –∑–≤–æ–Ω–∫–∞
callManager.rejectCall(remoteUsername);

// –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–≤–æ–Ω–∫–∞
callManager.endCall();

// –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∏–∫—Ä–æ—Ñ–æ–Ω–æ–º
const enabled = callManager.toggleMicrophone();
const state = callManager.getMicrophoneState();

// –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —ç–∫—Ä–∞–Ω–∞
await callManager.startScreenShare();
callManager.stopScreenShare();
```

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- –ó–≤–æ–Ω–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ –º–µ–∂–¥—É –¥–≤—É–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (P2P)
- –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —ç–∫—Ä–∞–Ω–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –≤–æ –≤—Ä–µ–º—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∑–≤–æ–Ω–∫–∞
- –¢—Ä–µ–±—É–µ—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è HTTPS –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –º–µ–¥–∏–∞-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º

## –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

- [ ] –ì—Ä—É–ø–ø–æ–≤—ã–µ –∑–≤–æ–Ω–∫–∏ (3+ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤)
- [ ] –í–∏–¥–µ–æ-–∑–≤–æ–Ω–∫–∏ —Å –∫–∞–º–µ—Ä–æ–π
- [ ] –ó–∞–ø–∏—Å—å –∑–≤–æ–Ω–∫–æ–≤
- [ ] –£–ª—É—á—à–µ–Ω–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∑–≤—É–∫–∞ (—ç—Ö–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ, —à—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ)
- [ ] –ò—Å—Ç–æ—Ä–∏—è –∑–≤–æ–Ω–∫–æ–≤
- [ ] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
